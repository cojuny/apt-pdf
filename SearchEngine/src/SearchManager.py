from collections import defaultdict
import spacy
from Document import Document
from LexicalSearch import LexicalSearch
from KeywordSearch import KeywordSearch
from SemanticSearch import SemanticSearch
from ResultQueue import end_of_search, end_of_init

class SearchManager:
    
    def __init__(self):
        self.documents = defaultdict(Document)
        self.token_processor = spacy.load("en_core_web_sm")
        self.lexical = LexicalSearch()
        self.keyword = KeywordSearch()
        self.semantic = SemanticSearch()
        print("END OF INIT")
        end_of_init()

    def lexical_search(self, id:str, targets:list, connectors:list, scope:str):
        doc = self.documents[id]
        
        if len(targets) <= 1:
            self.lexical.kmp_search(
                id=id, 
                target=targets[0], 
                scope=scope, 
                text=doc.text, 
                words=doc.words, 
                sents=doc.sents)
        else:
            self.lexical.ac_search(
                id=id, 
                targets=targets,
                connectors= connectors,
                scope=scope,
                text=doc.text,
                words=doc.words,
                sents=doc.sents)
        end_of_search(id)
            

    def keyword_search(self, id:str, target:str=None, target_pos:str=None, synonyms:bool=False):
        doc = self.documents[id]
        if not target:
            self.keyword.search_pos_only(
                id=id,
                words=doc.words,
                pos=doc.pos,
                target_pos=target_pos
                )
        else:
            self.keyword.search(
                id=id, 
                words=doc.words, 
                pos=doc.pos, 
                target=target.lower(), 
                target_pos=target_pos, 
                synonyms=synonyms
            )
        end_of_search(id)

    def semantic_search(self, id:str, query:str, threshold:int):
        doc = self.documents[id]
        self.semantic.search(
            id=id,
            sentences=doc.sents,
            query=query,
            threshold=threshold
        )
        end_of_search(id)

    def add_document(self, text: str, id: str) -> None:
        self.documents[id] = Document(text, id, self.token_processor)
        end_of_init()
    
    def del_document(self, id: str) -> bool:
        if id in self.documents:
            del self.documents[id]
            end_of_init()
            return True
        else:
            end_of_init()
            return False
        

    

if __name__ == '__main__':
    text = '''
    \n \n \n \n \n \nDepartment of Computing \n \nCOMP4913 Capstone Project \nHandbook \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nSeptember 2023 \n \nThis Capstone Project Handbook is subject to review and changes which the subject offering Department can \ndecide to make from time to time. Students will be informed of the changes as and when appropriate.  \n \nTable of Contents \n \nPart 1: Capstone Project Timeline ....................................................................................................................... 1 \n \nPart 2: Project Selection and Assignment ............................................................................................................ 2 \n \n2.1  Proposed Projects, Rationale and Publicity .............................................................................................. 2 \n2.2 Project Information Session ...................................................................................................................... 2 \n2.3 Project Selection and Allocation............................................................................................................... 2 \n2.3.1 First Round Allocation ................................................................................................................ 2 \n2.3.2 Second Round Allocation ............................................................................................................ 3 \n2.3.3 Final Round Allocation ............................................................................................................... 3 \n2.3.4 Special Arrangement for Previous Withdrawal Cases ................................................................ 3 \n2.3.5 Interview ..................................................................................................................................... 3 \n \nPart 3: Change of Project Title ............................................................................................................................ 4 \n \nPart 4: Project Proposal Submission .................................................................................................................... 4 \n \n4.1 Submission and Schedule ......................................................................................................................... 4 \n4.2 General Requirements .............................................................................................................................. 4 \n \nPart 5: Document Submission ............................................................................................................................. 5 \n \n5.1 Meeting Notes ........................................................................................................................................... 5 \n5.2 Interim Report ........................................................................................................................................... 5 \n5.3 Final Report .............................................................................................................................................. 6 \n5. 4 One-page Project Summary ...................................................................................................................... 6 \n5.5 Presentation Video .................................................................................................................................... 6 \n5.6 Presentation File ....................................................................................................................................... 7 \n5.7 Additional Files ........................................................................................................................................ 7 \n5.8 Individual Work ........................................................................................................................................ 7 \n5.9 Plagiarism ................................................................................................................................................. 7 \n \nPart 6: Presentations ............................................................................................................................................ 8 \n \n6.1 Objectives and General Information ......................................................................................................... 8 \n6.2 Before the Presentation ............................................................................................................................. 8 \n6.3 During the Presentation ............................................................................................................................ 8 \n6.4 After the Presentation ............................................................................................................................... 9 \n \nPart 7: Best Project Award Competition ............................................................................................................. 9 \n \nPart 8: Intellectual Property ................................................................................................................................. 9 \n \nPart 9: Assessment ............................................................................................................................................... 9 \n \n9.1 Criterion Referencing Assessment and Grading ..................................................................................... 10 \n9.1.1 Project Proposal ........................................................................................................................ 10 \n9.1.2 Interim Assessment ................................................................................................................... 10 \n9.1.3 Final Assessment ....................................................................................................................... 11 \n9.2 Penalty .................................................................................................................................................... 13 \n \n \nPart 10: Structure and Format Requirements of Proposal and Reports ............................................................. 14 \n10.1 Proposal .................................................................................................................................................. 14 \n10.1.1 Sample Structure of the Proposal .............................................................................................. 14 \n10.1.2 Formatting Requirements of the Proposal ................................................................................. 15 \n10.2 Interim/Final Report ............................................................................................................................... 16 \n10.2.1 Organization of the Reports ...................................................................................................... 16 \n10.2.2 Cover and Formatting Requirements of the Reports ................................................................. 16 \n10.2.3 Submission Requirements of the Reports ................................................................................. 17 \nAppendix ........................................................................................................................................................... 18 \nGuidelines for Students on the Use of Generative Artificial Intelligence 22 \nPreface \n \nTo help students develop their generic competencies, as well as prepare them for professional \npractice in the workplace, for further academic pursuits and for lifelong learning, the University \nhas a mandatory Capstone Project learning experience requirement for all four-year undergraduate \nprogrammes. Students are expected to consolidate their learning experiences accumulated over \ntheir entire undergraduate study in the Capstone Project. \n \nThis handbook aims to provide you with a better understanding of the Capstone Project, including \nthe allocation, proposal and report requirements, presentation arrangements, etc. \n \n \n \n \n \nPart 1: Capstone Project Timeline \n \n3 Apr 2023\nInformation Session\n7 - 17 Apr 2023\nProject Selection (First Round)\n8 - 10 May 2023\nInterview (First Round)\n26 - 28 May 2023\nProject Selection (Second Round)\n13 - 18 Jun 2023\nProject Selection (Final Round)\n27 Oct 2023\nProject Proposal Submission\n15 Jan 2024\nInterim Report and Presentation Video Submission\n12 Apr 2024\nFinal Report Submission\n20 - 24 Apr 2024\nFinal Presentation\n7 Jun 2024 (TBC)\nBest Project Award Competition (Selected Projects Only)\n  \n1 \n \nPart 2: Project Selection and Assignment \n \n2.1  Proposed Projects, Rationale and Publicity \n \ni. Each faculty member will be assigned with an appropriate capstone project \nsupervision loading by the Department; \nii. Faculty members will prepare a list of proposed projects and specify the quota for \neach project, together with a brief description and expected outcomes of the project; \nand \niii. The list of project proposals will be assembled and posted on the Intranet before each \nproject selection round. Please refer to the Capstone Project Timeline for details. \n \n \n2.2 Project Information Session \n \ni. During the project information session, some project supervisors will introduce their \nproposed projects to the students; and \nii. List of projects with introductory session will be given in the rundown posted on the \nIntranet before the information session. \n \n \n2.3 Project Selection and Allocation \n \n2.3.1 First Round Allocation \n \ni. Students should submit a project preference form indicating 10 interested projects, in \ndescending order, via the Capstone Project Selection System; \n \nStudents Projects to Choose \nBSc Computing/ IT Category A projects only \nBSc EIS Category B projects only \nBSc Information Security Category C projects only \nBSc FinTech/ FinTech and AI Category D projects only \n \nii. During the interview period (refer to 2.3.5 for more details about interviews), students \nmay resubmit their project preference form if they would need to re-prioritize or delete \nsome of their project choices. However, NO new projects can be added; \niii. Similar to the well-known JUPAS allocation model, a fair computer program will be \nrun to allocate capstone projects to students; and \niv. Project allocation result and remaining projects for next round will be posted on the \nIntranet 1 week after the interview period. \n \n  \n2 \n \n2.3.2 Second Round Allocation \n \ni. This round is only applicable to students who were not allocated a project in the First \nround; and \nii. It follows the same processes as of the First round, except: \n \nStudents Projects to Choose \nBSc Computing/ IT/ EIS Category A or B projects only \nBSc Information Security Category C projects only \nBSc FinTech/ FinTech and AI Category D projects only \n \n2.3.3 Final Round Allocation \n \ni. After the release of Second round allocation results, students who have not been \nassigned with a project should submit a new selection form via the Capstone Project \nSelection System; \nii. The selection form should indicate student\u2019s 10 interested projects and 5 areas in \ndescending order; \niii. The Capstone Project coordinator will assign projects to students based on students\u2019 \npreferences and staff supervision quota with the following process \na. All 1st choices of students\u2019 preferences will be processed. If more than one \nstudents select the same project with the same preference, the project will be \nassigned randomly to one of them; \nb. The same rule is used to process all 2nd choices for remaining students (not yet \nassigned projects) and so on.  The process will be repeated until all 10 interested \nprojects are used up; \nc. For the remaining students (not yet have a project assigned), they are randomly \nselected to assign a supervisor according to their interested areas; and \niv. After the assignment results are finalized, it will be posted on the Intranet. \n \n2.3.4 Special Arrangement for Previous Withdrawal Cases \n \nStudents who have withdrawn from their capstone projects may choose to bypass the \nselection process if they are retaking the same project with the same supervisor. Students \nwho opt for this arrangement must work out the details with their supervisor and \ninform the General Office via email (comp.capstone@polyu.edu.hk) by the end of the \nFirst round interview period. \n \n2.3.5 Interview \n \ni. The list of students who are interested in each project is made known to the project \nsupervisor. Supervisors would decide whether or not to conduct interviews for \ninterested students; \nii. Interviews will only be arranged for the first two rounds of project selection and \nstudents may have multiple interview offers; and \niii. Schedules will be posted on the Intranet before each interview period. \n  \n3 \n \nPart 3: Change of Project Title \n \nTo allow sufficient time to conduct the Capstone Project, students are not advised to change their \nproject titles after project allocation. However, modifications on the project title are acceptable \nwhen these are agreed by the project supervisors.  \n \nStudents may modify the project title via Capstone Project Submission System during submission \nperiods of project proposal, interim report and final report. You will receive an on-screen \nnotification and a system-generated email for successful updating. \n \nAfter the submission of final report, students are not allowed to modify the project title only except \nwhen there is a genuine need to do so. Students will need to seek supervisor\u2019s endorsement via \n\u201cProject Title Final Change Form\u201d (Appendix C) during the final presentation. The signed form \nshould be submitted to the General Office once after the final presentation. \n \n \nPart 4: Project Proposal Submission \n \n4.1 Submission and Schedule \n \nStudents should upload ONE soft copy (in PDF format) of the project proposal to Capstone \nProject Submission System before the deadline specified in the Capstone Project Timeline. \nPlease make sure you have received an on-screen notification and a system-generated \nemail for successful uploading. \n \n \n4.2 General Requirements \n \nThe project proposal should outline the project topic to be investigated. To write a good \nproposal, a thorough and systematic review of the related work must be conducted. You \nshould clearly define the problem(s) to be solved, indicate the significance of the potential \nsolution(s), understand the methodologies and techniques to be used, and propose a work \nplan. Consequently, the proposal should include sections on its background, problems, \nobjectives, methods to be used, expected deliverables/outcomes, and an estimated \nschedule. \n \nFor the sample structure and formatting requirements of the proposal, please refer to Part \n10. \n \n \n  \n4 \n \nPart 5: Document Submission \n \nBelow please find the summary of document submission for interim and final assessment: \n \nDocuments Interim Assessment Final Assessment \nMeeting Notes   \nInterim / Final Report   \nTurnitin Report   \nOne-page Project Summary   \nDeclaration of Originality   \nPresentation Video (<15min)   \nPresentation File    \n \nPlease make sure you have received an on-screen notification and a system-generated email for \nevery successful uploading. \n \n5.1 Meeting Notes \n \ni. Students should meet with their supervisors regularly. For project management \npurposes, meeting notes should be prepared to record the meeting discussion, action \npoints, problems encountered and other related information. For example, the meeting \nnotes should and record the supervisor\u2019s feedback on project proposal and the \ncorresponding action points. The meeting notes should be reviewed by your \nsupervisor; \nii. If students are working in the same project group, there should be differences in \nmeeting notes for each student as the preparation of meeting notes is an individual \nwork; \niii. Students should submit at least four sets of meeting notes (in PDF format) together \nwith the interim report (i.e., at least 4 sets between September and December) and \nfinal report (i.e., at least 4 sets between January and April) for assessment based on \nthe rubric in Part 9 to the Capstone Project Submission System; and \niv. There is no need to submit the meeting notes to the Turnitin System.  \n \n \n5.2 Interim Report \n \ni. Students should submit an interim report (in PDF format) to the Capstone Project \nSubmission System, which is expected to contain the skeleton of the final report; \nbefore the deadline specified in the Capstone Project Timeline. Late submissions will \nnot be accepted. Please refer to Section 9.2 for more details of penalty; \nii. For group projects in which a student is doing certain part, he/she should submit an \nindividual interim report to give an overview of the project and to report his/her own \nprogress in contributing to the bigger project. Please refer to Section 5.8 for more \ndetails of individual work requirements; \niii. The report, excluding preamble and appendices, should normally not exceed 50 pages \nin length; and \niv. For the report cover, formatting and submission requirement, please refer to Part 10. \n5 \n \n5.3 Final Report \n \ni. Students should submit a final report (in PDF format) to the Capstone Project \nSubmission System before the deadline specified in the Capstone Project Timeline. \nLate submissions will not be accepted. Please refer to Section 9.2 for more details of \npenalty; \nii. For group projects in which a student is doing certain part, he/she should submit an \nindividual report to give an overview of the project and to provide the proper context \nand to explain clearly his/her own contributions within the bigger project. Please refer \nto Section 5.8 for more details of individual work requirements; \niii. The report, excluding preamble and appendices, should normally not exceed 50 pages \nin length; \niv. The report should be submitted to the Turnitin System to generate the similarity report. \nThe similarity report (in PDF format) should be submitted to the Capstone Project \nSubmission System; \nv. After generating the similarity report, students are required to submit the form \n\u201cDeclaration of Originality\u201d (Appendix B) in PDF format together with the final \nreport to the Capstone Project Submission System; and \nvi. For the report cover, formatting and submission requirements, please refer to Part 10. \n \n \n5.4 One-page Project Summary \n \ni. In addition to the final report, students should also submit an one-page project \nsummary (in MS Word) based on the IEEE paper format^ (i.e., using an academic \npaper format) to the Capstone Project Submission System. The project summary is \nassessed based on the rubric in Part 9; \nii. A template can be found in the COMP Intranet; and \niii. Selected project summaries with the consistent academic paper format will be \npublished as a capstone project summary booklet for archival purposes. \n \n^ IEEE paper format (https://www.ieee.org/conferences/publishing/templates.html) \n \n \n5.5 Presentation Video \n \ni. In interim assessment, students should submit a 10~15min presentation video in mp4 \nformat to the Capstone Project Submission System. The video should be at least 720p \nand no longer than 15 minutes.  \nii. Please make sure the fonts in presentation slides are clearly legible in the presentation \nvideo and the video can be played smoothly.  \niii. For identification and authentication purpose, students should show student ID at the \nbeginning of the presentation video and show the presenter\u2019s face throughout the \npresentation video.  \niv. Students can use Microsoft Teams, Zoom or other softwares to make the presentation \nvideo. If Zoom is used, please note that NOT the entire powerpoint (during screen-\nsharing) could be captured by the camera. The top right-hand corner would be covered.  \n6 \n \n5.6 Presentation File \n \ni. Students should submit a presentation file at the END of the interim and final \npresentations to the Capstone Project Submission System; and \nii. The presentation file should be converted into PDF format and named as \n\u201817001234d.pdf\u2019, where 17001234d is to be replaced by the student ID. \n \n \n5.7 Additional Files \n \nStudents may zip and submit other files (e.g., source code) in one zip file to the Capstone \nProject Submission System. \n \n \n5.8 Individual Work \n \ni. Students are expected to submit individual reports and should not duplicate, either \nwholly or partially, the work of other students without proper acknowledgement and \nprior agreement from the other students concerned;  \nii. Students should not use GenAI tools (e.g., ChatGPT) to generate reports or codes \nwithout proper acknowledgement and supervisor\u2019s approval; and \niii. For group projects in which a student is doing certain part, he/she should submit an \nindividual report to give an overview of the project and to provide the proper context \nand to explain clearly his/her own contributions within the bigger project. In the \nindividual report, the student should 1) clearly specify that his/her work is a part of a \ngroup project; 2) list all group members; and 3) summarize each member\u2019s individual \ncontribution in the group project in the Declaration of Individual Contribution in \nGroup Project (Appendix D). The declaration form (in PDF format) should be \nsubmitted to the Capstone Project Submission System. \n \n \n5.9 Plagiarism \n \nIt is students\u2019 responsibility to ensure that all their reports are plagiarism-free. The \nUniversity highly regards the importance and value of academic honesty, thus students \nwho have committed plagiarism will be subject to disciplinary actions by the University. \nAny suspected text in the report, a paragraph or even a single sentence, will probably lead \nto a reduction on the overall grade of the report. More serious cases would lead to further \ndisciplinary actions, including failing the project, and/or awarded with one lower honour \nclassification, and/or even de-registration from the University. \n \n \nIf you encounter any technical problem of document submission and/or do not receive the on-\nscreen notification and system-generated email after updating/uploading, please contact the \nTechnical Team via email  (helpdesk@comp.polyu.edu.hk). \n  \n7 \n \nPart 6: Presentations \n \n6.1 Objectives and General Information \n \nThe objectives of the presentations are twofold:  \n1. it is an assessment component of the Capstone Project; and \n2. it is an occasion for interested parties to participate. \n \nOwing to the limited amount of time for each presentation/demonstration session, the \nsession should be conducted in a controlled manner. Being the chairman of your session, \nyour supervisor would conduct the session and allow time for presentation, demonstration, \nand question and answer in that order.  \n \nVideo Recording of the Presentation \nThe interim presentations will be video-recorded. The final presentations will be face-to-\nface. The purpose of recording is mainly for the assessment of the Capstone Project. \nSelected videos will also be shown to authorised panels during quality assurance and \naccreditation exercises. The followings are some guidelines to assist you in your \npresentation/demonstration. \n \n \n6.2 Before the Presentation \n \ni. Set up your presentation/demonstration files well before your presentation session; \nii. If you bring your own notebook for presentation, you should prepare a Display \nAdapter suitable for VGA or HDMI projection. Testing in one/more days in advance \nin the assigned presentation room is highly recommended; and \niii. No presentation pointer will be provided. Students should bring their own ones. \n \n \n6.3 During the Presentation \n \ni. Each session would start at either \u201c00\u201d or \u201c30\u201d minutes in an hour, thus it would \nend sharply at the corresponding \u201c20\u201d or \u201c50\u201d minutes in an hour. If you find that \nyour previous presenter has overrun his/her time, i.e. if he/she is using up your time, \nyou have the privilege to demand him/her to hand over the venue to you immediately; \nii. Use English in your presentation; \niii. Be relaxed and well-dressed for the occasion; \niv. Be on time. Marks would be deducted for overrunning and the chairman and co-\nexaminer could terminate the presentation when it overruns; and \nv. You should have at most 20 minutes for the presentation, including: \n Presentation of your results and/or products \n Demonstration \n Question and Answer \n \n \n8 \n \n6.4 After the Presentation \n \nYou are required to upload your powerpoint file (in PDF format) to the Capstone Project \nSubmission System once the presentation is finished.  \n \n \nPart 7: Best Project Award Competition \n \nOutstanding projects will be selected to compete for the Best Project Award. While selected \nstudents will be contacted by the Department on an individual basis, all students should reserve \nthe date, as shown in the Capstone Project Timeline, to join this annual event. \n \n \nPart 8: Intellectual Property \n \nThe Capstone Project, as intellectual property created by students, shall be owned by the \nUniversity. Details of intellectual property could be found in the Student Handbook. \n \n \nPart 9: Assessment \n \nEach capstone project is assessed by the supervisor, a co-examiner and a 2nd assessor1 using \nrubric-based assessment. Unless otherwise specified, the weighting percentage for all assessment \ncomponents are as follows: \n \n Supervisor Co-Examiner 2nd Assessor \nInterim Assessment 60% 40% N/A \nFinal Assessment 50% 30% 20% \n \nThe interim assessment and final assessment account for 20% and 80% of the overall grade \nrespectively. \n \nTo maintain consistency and ensure quality among all capstone projects, there is also a quality \nassurance committee to manage the overall assessments. A student grade may be adjusted by the \nquality assurance committee for consideration and approval by the Subject Assessment Review \nPanel (SARP) committee. \n \n \n  \n                                                          \n1 2nd Assessor would only assess the final report and final presentation. \n9 \n \n9.1 Criterion Referencing Assessment and Grading \n \nWith the universities\u2019 implementation of criterion-referencing assessment, all subjects \nmust be assessed against a set of objective criteria. The generic criteria for the assessment \nof capstone projects are: \n \n9.1.1 Project Proposal \n \nA project proposal is assessed by the supervisor to make a pass/fail decision in accordance \nwith the following holistic rubric.  \n \nPass Fail \nSatisfactory project proposal with a Unsatisfactory project proposal (e.g., \nsatisfactory project plan. All pre-requisite without a feasible project plan) or pre-\nstudy/requirement(s) fulfilled. requisite study/requirement(s) not \nfulfilled. \n \nNote that a supervisor can set pre-requisite study/requirements for his/her student such as \nstudying for some e-learning materials related to the Capstone Project. A student cannot \nproceed with his/her project without getting a \u201cPass\u201d grade for the project proposal. \n \n9.1.2 Interim Assessment \n \n Interim assessment uses the following rubric for project assessment: \n  \n% A+ (4.3) / B+ (3.3) / C+ (2.3) / D+ (1.3) / F (0.0) \nA (4.0) / B (3.0) /  C (2.0) /  D (1.0) \nA- (3.7) B- (2.7) C- (1.7) \nBackground and 25% Excellent Clear background Basic relevant Barely relevant Irrelevant \nRelated Work background, and with most background with background and background with \n(PILO 6) comprehensive relevant sufficient minimal insufficient \nreferences with references and references and references with references and \ncomplete review good overview basic overview. brief review and many errors and \nand in-depth and analysis. obvious omissions. \nanalysis. deficiencies. \nProblem 15% Very well- Clear problem(s) Acceptable Unclear Unacceptable \nDefinition and defined and and objective(s) problem(s) and problem(s) and problem(s) and \nObjectives motivated with suitable objective(s) with objective(s) with objective(s) with \nproblem(s) with scope. suitable scope but obvious many \nclear and room for deficiencies (e.g., deficiencies. \nattainable improvement. unclear scope). \nobjective(s). \nDesign/ 25% Thorough design/ Good design/ Basic design/ Weak design/ Poor design/ \nMethodology, methodology,  methodology and methodology and methodology and methodology and \nCritical Thinking academically good critical basic critical weak critical lack of critical \nand Preliminary rigorous and thinking with thinking with thinking with thinking with \nResult excellent critical minor room for obvious many \n(PILO 4) thinking (e.g., deficiencies. improvement. deficiencies. deficiencies. \nconsidering Good preliminary Sufficient Barely sufficient Little or no \ndifferent result available preliminary result preliminary result preliminary \nalternatives). (e.g., for available but with (e.g., very little result. \nExcellent demonstrating the some work). \npreliminary result feasibility). deficiencies. \nbased on solid \nwork. \n10 \n \n \n% A+ (4.3) / B+ (3.3) / C+ (2.3) / D+ (1.3) / F (0.0) \nA (4.0) / B (3.0) /  C (2.0) /  D (1.0) \nA- (3.7) B- (2.7) C- (1.7) \nReport Writing 15% Very well-written Well-written and Readable and Barely readable Unreadable with \n(PILO 1) and well- well-structured structured but and structured many \nstructured with with clear with room for with obvious deficiencies. \nfluent English, discussion and improvement in deficiencies. No interim report \nand very clear explanation but some aspects. submission \ndiscussion and minor \nexplanation. deficiencies. \nPresentation 15% Comprehensive Good, easy to Basic Weak Poor presentation \n(PILO 1) and very clear follow presentation presentation showing little \nlogical presentation showing basic showing weak understanding.  \npresentation showing good understanding understanding No presentation \nshowing in-depth understanding with acceptable with major f ile or video. \nunderstanding. with minor deficiencies.. deficiencies. \ndeficiencies. \nProject 5% Frequent Regular meetings Sufficient Barely sufficient Insufficient \nManagement   meetings with with good meetings with meetings with meetings with \nand Meeting excellent preparation. satisfactory weak preparation.  poor preparation. \nNotes (at least 4 preparation and Good meeting preparation.  Weak meeting Unclear meeting \nbetween self-initiative. notes with clear Satisfactory notes with notes.  \nSeptember and Excellent discussion and meeting notes unclear points.  Poor project \nDecember) ** meeting notes action points but with room for Project conducted management with \nwith very clear minor improvement.  according to a many \ndiscussion and deficiencies.  Project conducted barely acceptable deficiencies. \nconcrete action Project conducted according to an plan with some \npoints.  according to a acceptable plan. deficiencies. \nProject conducted clear plan. \naccording to a \nvery well-defined \nplan. \nNote: PILO - Programme\u2019s Intended Learning Outcome \nRemarks: ** Project Management and Meeting Notes will be evaluated only by supervisors. \n \n9.1.3 Final Assessment \n \nFinal assessment uses the following rubric for project assessment: \n  \n% A+ (4.3) / B+ (3.3) / C+ (2.3) / D+ (1.3) / F (0.0) \nA (4.0) /  B (3.0) /  C (2.0) /  D (1.0) \nA- (3.7) B- (2.7) C- (1.7) \nBackground 5% Excellent Clear background Basic relevant Barely relevant Irrelevant \nand Related background, and with most background with background and background with \nWork comprehensive relevant sufficient minimal insufficient \n(PILO 6) references with references and references and references with references and \ncomplete review good overview basic overview. brief review and many errors and \nand in-depth and analysis. obvious omissions. \nanalysis. deficiencies. \nProblem 5% Very well- Clear problem(s) Acceptable Unclear Unacceptable \nDefinition and defined and and objective(s) problem(s) and problem(s) and problem(s) and \nObjectives motivated with suitable objective(s) with objective(s) with objective(s) with \nproblem(s) with scope. suitable scope but obvious many \nclear and room for deficiencies (e.g., deficiencies. \nattainable improvement. unclear scope). \nobjective(s). \nDesign/ 15% Thorough design/ Good design/ Basic design/ Weak design/ Poor design/ \nMethodology methodology,  methodology and methodology and methodology and methodology and \nand Critical academically good critical basic critical weak critical lack of critical \nThinking rigorous and thinking with thinking with thinking with thinking with \n(PILO 4) excellent critical \n11 \n \n \n% A+ (4.3) / B+ (3.3) / C+ (2.3) / D+ (1.3) / F (0.0) \nA (4.0) /  B (3.0) /  C (2.0) /  D (1.0) \nA- (3.7) B- (2.7) C- (1.7) \nthinking (e.g., minor room for obvious many \nconsidering deficiencies. improvement. deficiencies. deficiencies. \ndifferent \nalternatives). \nProblem 45% Problem solved Problem solved Problem solved Problem barely Very little \nSolving, optimally and in by good with solved with problem solving, \nImplementation a comprehensive  techniques (e.g., basic/standard obvious implementation \nand Evaluation manner (e.g., overcoming technique (e.g., deficiencies, and and evaluation \n(PILO 5) innovative or difficult overcoming little with many \ncomplex problems) with standard implementation deficiencies. \napproach) with almost complete problems) with and evaluation. \ncomplete implementation basic \nimplementation and evaluation. implementation \nand evaluation. and evaluation. \nReport Writing 10% Very well-written Well-written and Readable and Barely readable Unreadable with \n(PILO 1) and well- well-structured structured but and structured many \nstructured with with clear with room for with obvious d eficiencies. \nfluent English, discussion and improvement in deficiencies. \nand very clear explanation but some aspects. \ndiscussion and minor \nexplanation. deficiencies. \nPresentation 10% Comprehensive Good, easy to Basic Weak Poor presentation \n(PILO 1) and very clear follow presentation presentation showing little \nlogical presentation showing basic showing weak understanding. \npresentation showing good understanding understanding Poor response to \nshowing in-depth understanding with acceptable with major questions. \nunderstanding. with minor deficiencies. deficiencies. No presentation \nExcellent deficiencies. Major questions Questions file. \nresponse to all Good response to answered. answered \nquestions. major questions. unsatisfactorily. \nProject 5% Frequent Regular meetings Sufficient Barely sufficient Insufficient \nManagement   meetings with with good meetings with meetings with meetings with \nand Meeting excellent preparation. satisfactory weak preparation.  poor preparation. \nNotes (at least 4 preparation and Good meeting preparation.  Weak meeting Unclear or no \nbetween self-initiative. notes with clear Satisfactory notes with meeting notes.  \nExcellent discussion and meeting notes unclear points.  Poor project \nJanuary and meeting notes action points but with room for Project conducted management with \nApril) ** with very clear minor improvement.  according to a many \ndiscussion and deficiencies.  Project conducted barely acceptable deficiencies. \nconcrete action Project conducted according to an plan with some \npoints.  according to a acceptable plan. deficiencies. \nProject conducted clear plan. \naccording to a \nvery well-defined \nplan. \nOne-page 5% Very well-written Well-written and Readable and Barely readable Unreadable with \nProject and well- well-structured structured but and structured many \nSummary structured with with clear with room for with obvious deficiencies. \n(IEEE paper fluent English, summary but improvement in deficiencies. More than one \nformat) and very clear minor some aspects. page (e.g., one \nand concise deficiencies. page plus one \nsummary. line in Page 2). \nNote: PILO - Programme\u2019s Intended Learning Outcome \nRemarks: ** Project Management and Meeting Notes will be evaluated only by supervisors. \n \nStudents will also be assessed on the extent to which they have accomplished their project \nobjectives as stated in the project proposal. The degree of difficulty and originality of the \nproject objectives will also be considered when assessment is being made. In general, with \n12 \n \neverything being equal, projects meeting more difficult objectives and demonstrating \ncreativity will be awarded higher grades than those which meet easier objectives and show \nno original ideas. So it is important to work out with your project supervisor a set of \nrealistic and challenging objectives for your project in the planning stage. \n \n \n9.2 Penalty \n \nFor fairness and holistic assessment, students are expected to fulfil all assessment \nrequirements. A failure grade will be given for the whole project if a student fails to fulfil \nkey assessment requirements (e.g., no final report submission or absent from final \npresentation). Late submission will not be accepted unless with exceptional approval or \nunder special circumstances (e.g., health reasons). Otherwise, one letter grade will be \ndeducted from your final grade for each day of late submission. For late assessment, please \nsubmit your request together with supporting documents (e.g. medical certificate) to the \nGeneral Office via email (comp.capstone@polyu.edu.hk) within 5 working days. \n \nGroup Project and Use of Other Works \nFor group projects, there should be clearly defined individual components for the involved \nstudents. The work distribution should be clearly defined in the reports. Furthermore, each \nstudent should only include his/her individual work in the main sections of the report and \npresentation. If required, any work of other students can be included in an appendix for \nreference purposes. In addition, in the individual report, the student should 1) clearly \nspecify that his/her work is a part of a group project; 2) list all group members; and 3) \nsummarize each member\u2019s individual contribution in the group project in the Declaration \nof Individual Contribution in Group Project (Appendix D). \n \nSimilarily, if a student\u2019s work is based on other student\u2019s work (e.g., previous capstone \nproject work or work of a research student), he/she should acknowledge previous work \nand clearly specify the student\u2019s individual contribution in the report. The previous works \nshould be included in an appendix for reference purposes. \n \nStudents who fail to follow this requirement may be downgraded on a case-by-case basis \nor given a \u201cFail\u201d grade for serious cases. \n \n \n  \n13 \n \nPart 10: Structure and Format Requirements of Proposal and Reports \n \n10.1 Proposal \n \n10.1.1 Sample Structure of the Proposal \n \nThe following is a sample structure of a Capstone Project proposal. Please consult your \nsupervisor when preparing your proposal. \n \nCover Page \nThe cover page normally includes: \n1. Title of the project; \n2. Student ID no. of the student; \n3. Programme-stream;  \n4. Name of project supervisor; \n5. Date, etc. \n \nTable of Content \nThis page lists the content of the proposal. It is in the form of section headings followed \nby the corresponding page numbers. \n \nBackground and Problem Statement \nBefore you start your project, you must understand the background and identify the \nproblem to be solved. You are expected to define the problem clearly and accurately, and \ndescribe explicitly the context, motivation, characteristics, and significance of the problem \nto be solved. \n \nObjectives and Outcome \nAn objective is a specific, measurable outcome of your project. This section therefore \ndescribes what your project is going to achieve and the expected outcome. Try to define \nthe scope of your project accurately. The objective could also be devising and evaluating \nnew approaches to solve a problem. Given the specified objectives, you may want to \nhighlight the contribution to be made by your project in the related area. \n \nProject Methodology \nThis section estimates the possibility of being able to achieve your objectives within the \nlimited period of time, by outlining the approach and techniques to be employed. To do \nso, you may need to divide the problem into several smaller problems, or divide your \nproject into several stages. You should describe your planned tasks for solving the problem \nand the methods to be used in each of the tasks. In writing this section, you may need to \nreview and compare existing work in related areas. Therefore, you may include a \nsubsection of literature review. \n \nProject Schedule \nYou need to propose a plan and a timetable to carry out the project. A good schedule will \nset out precisely what you are going to do, and when you are going to do it. In the plan, \n14 \n \nyou should write the milestones you expect to achieve and the conclusions you expect to \nreach along the way. Define the milestones with respect to your schedule. \n \nResources Estimation \nEstimate hardware and software resources required for carrying out your project. \n \nReferences/Bibliography \nList papers, articles, and perhaps online materials related to your project that you find in \nliterature review or tool demonstrations. Please use a uniform format for all the references, \ne.g., Author\u2019s last name, first name, followed by paper title, publication source, date, page \nnumbers, etc. Also please make sure you have cited these references in your proposal. You \nmay refer to the style of citation at the reference section of research papers that you are \nreading for examples. \n \n10.1.2 Formatting Requirements of the Proposal \n \nAll sections of the proposal, including references, must conform to the following \nguidelines: \n \n Font Style: Use one of these typefaces: Arial or Times New Roman at a font size of \n12 point. \n \nNOTE: Font sizes down to 10 point may be used for mathematical formulas or \nequations, figure, table, scheme or diagram captions and when using a Symbol font to \ninsert Greek letters or special characters. \n \n Line Spacing: The text of the document should be at least 1.5 spacing and no more \nthan double line-spaced. \n \n Margin: Left margin 25mm. Top, bottom and right margins 20mm. \n \n Layout: One column, single-sided or double-sided A4. \n \n Pagination: The report must carry sequential pagination throughout, including \nappendices. The page number should be on the top right margin of each page. The \ntitle page is counted in the numbering, but bears no page number. \n \n Length: The length of the proposal should normally be 5 to 10 pages including \neverything. Remember, quantity is no substitute for quality. \n \n \n  \n15 \n \n10.2 Interim/Final Report \n \n10.2.1 Organization of the Reports \n  \nThe following is an example illustrating the organization of your interim/final report. \n1. Cover page (Appendix A) \n2. Abstract \n3. Table of contents \n4. List of tables and figures \n5. Main body of text \n6. References/Bibliography \n7. Appendices (if any) \nEach chapter should start with a new page and be clearly divided into sections and sub-\nsections with appropriate headings and numberings. \n \nThe final report should be a document of high professional standard. It should be self-\nstanding and coherent, well organized and presentable. Materials from previous \ndeliverables (e.g., the project proposal and interim report) should be re-structured and \nintegrated in order to ensure that the final report is a complete and readable document. \n \nAlthough there are no specific requirements on the contents of the main body of the text, \nthe report should contain a clear and explicit statement of the problem and the objectives \nof the project in its beginning chapters. To let the examiners better assess your work, your \nreport should include a section on what has been achieved (your contributions). Please \nconsult with your supervisor for the report requirements. \n \n10.2.2 Cover and Formatting Requirements of the Reports \n \nThe cover page should include: \n1. Title of the project; \n2. Student ID no. of the student; \n3. Programme stream;  \n4. Name of project supervisor; \n5. Date \n \n*As students\u2019 reports will be kept by the Department for demonstration/ or sharing to other \nstudents to enhance their learning, please do not put your name and other personal \nparticulars on the report, except the cover page. \n \nAll sections of the report, including references, must conform to the following guidelines: \n \n Font Style: Use one of these typefaces: Arial or Times New Roman at a font size of \n12 point. \n \nNOTE: Font sizes down to 10 point may be used for mathematical formulas or \nequations, figure, table, scheme or diagram captions and when using a Symbol font to \ninsert Greek letters or special characters. \n16 \n \n \n Line Spacing: The text of the document should be at least 1.5 spacing and no more \nthan double line-spaced. \n \n Margin: Left margin 25mm. Top, bottom and right margins 20mm. \n \n Layout: One column, single-sided or double-sided A4. \n \n Pagination: The report must carry sequential pagination throughout, including \nappendices. The page number should be on the top right margin of each page. The \ntitle page is counted in the numbering, but bears no page number. \n \n Length: The length of the report should normally not exceed 50 pages excluding \npreamble and appendices. Remember, quantity is no substitute for quality. \n \n10.2.3 Submission Requirements of the Reports \n \nThe soft copy of the report should follow a standard format and has a limit in its size, \nwhich is set as follows: \n1. In PDF format; and \n2. The maximum file size should be 50MB. If your report has a size larger than 50MB, \nplease submit your file in PDF format via a CD-ROM to the General Office (PQ806) \nwithin the submission schedule. Please mark your student ID no. and programme-\nstream code on the cover of the CD-ROM. \n  \n17 \n \nAppendix \n \n \nA Report Cover Sheet (Sample) \nB Declaration of Originality \nC Project Title Final Change Form \nD Declaration of Individual Contribution in Group Project \n \nRemarks: Files in MS Word format are available in COMP Intranet. \n \n \n  \n \n18 \n \nA. Report Cover Sheet (Sample) \n \n \n \nThe Hong Kong Polytechnic University \nDepartment of Computing \n \n \nCOMP4913 Capstone Project \nReport (Interim / Final*) \n \n \n \n \n \n \nType Your Project Title Here \n \n \n \n \n \n \n \n \n \n \nStudent Name: Chan Tai Man \nStudent ID No.: 20xxxxxxD \nProgramme-Stream Code: 61xxx-xxx \nSupervisor: Dr John Chan \nCo-Examiner: Dr Amy Wong \n2nd Assessor: Prof. Paul Lau \nSubmission Date: xx January 2024 \n \n \n*Please delete as appropriate.  \n \n \nB. Declaration of Originality \n \n \n \nThe Hong Kong Polytechnic University \nDepartment of Computing \n \nCOMP4913 Capstone Project \n \n \nStudent Name :  \nStudent ID No. :  \nProgramme-Stream Code :  \nProject Title :  \nSupervisor Name :  \n \n************************************************************************ \n \nDECLARATION OF ORIGINALITY \n \nExcept where reference is made in the text of this Capstone Project Report, I declare that this \nreport contains no material published elsewhere or extracted in whole or in part from any works \nor assignments presented by me or any other parties for another subject. In addition, it has not \nbeen submitted for the award of any other degree or diploma in any other tertiary institution. \n \nNo other person\u2019s work has been used without due acknowledgement in the main text of the \nReport. \n \nI fully understand that any discrepancy from the above statements will constitute a case of \nplagiarism and be subject to severe academic penalties that may lead to deregistration from the \nprogramme. The department reserves the right to check the paper and electronic submissions \nof the Report via various mechanisms, such as Turnitin. \n \n \n \n \nSignature:  \nDate:  \n \n  \n \n \nC. Project Title Final Change Form \n \n \n \nThe Hong Kong Polytechnic University \nDepartment of Computing \n \nCOMP4913 Capstone Project \n \n \nPROJECT TITLE FINAL CHANGE FORM \n \n \nPlease fill in the form and submit the signed form to General Office right after the final \npresentation. \n \n \nStudent Name :  \nStudent ID No. :  \nProgramme-Stream Code :  \n   \nOriginal Project Title :  \n   \n   \nRevised Project Title :  \n   \n   \n   \nSupervisor Name :  \n \n \nApproved by Supervisor :  \nDate :  \n \n \n  \n \n \nD. Declaration of Individual Contribution in Group Project \n \n \nThe Hong Kong Polytechnic University \nDepartment of Computing \n \nCOMP4913 Capstone Project \n \n \nDECLARATION OF INDIVIDUAL CONTRIBUTION IN GROUP PROJECT \n \nStudent Name :  \nStudent ID No. :  \nProgramme-Stream Code :  \nProject Title :  \nSupervisor Name :  \n \n************************************************************************ \n \n I declare that this work is not a part of a group project. \n \n I declare that this work is a part of a group project including the following members: \n \nStudent Name:  (Student ID No.:  ) \nStudent Name:  (Student ID No.:  ) \nStudent Name:  (Student ID No.:  ) \n \nEach member\u2019s individual contribution in the group project can be summarized as follows.  \n \n \n \n \n \n \n \nSignature:  \nDate:  \n \n \n \n \nGuidelines for Students on the Use of Generative Artificial Intelligence \n(Effective from 2022/23 Summer Term) \nPolyU\u2019s stance \nPolyU takes an open and forward-looking stance on the use of generative artificial intelligence (GenAI) \ntools (such as ChatGPT) as a positive and creative force in education, and the incorporation of such use \nin innovative learning, teaching, and assessment practices. While embracing the use of new technology \nin education, PolyU upholds the principle that students must adhere to high standards of academic \nintegrity in all forms of assessments. The Student Code of Conduct and the policy on academic integrity \napply to the use of GenAI in student work.  \nRespect your own work and the work of others \nIn accordance with the above stance, the University emphasises that: \n\u2022 students are accountable for their own work; and\n\u2022 the use of GenAI (if permitted) in student work should be properly acknowledged.\nThe following guidelines apply to all subjects and levels of assessment: \n1. The use of GenAI tools may or may not be allowed in a subject, depending on the nature of the\nsubject and the objectives of the assessment tasks. You should refer to your subject and assessment\ndocuments to check if you may use GenAI tools in your assessments.\n2. All the work you submit for assessment should be YOUR OWN ORIGINAL work. Asking GenAI\nto do the assignment for you and submitting the work generated by GenAI, in part or in whole, as\nyour own (even in paraphrased form) constitute an act of academic dishonesty; it is no different\nfrom asking another person to write your assignment or claiming others\u2019 ideas as your own.\n3. For assessments that permit the use of GenAI tools, you may be required to declare the use of such\ntools and how they have been used in a form similar to the following:\nI/We declare that Generative AI tools have been used to prepare the submitted work. The\nGenerative AI tools used and the manner in which they were used are as follows:\n______________________________________________________________________________\n______________________________________________________________________________\n4. If you use AI-generated materials in your work, you must reference them in accordance with\naccepted academic conventions (e.g. APA or MLA styles).\n5. For assessments where any use of AI-generated materials is not permitted, students who are found\nto have submitted AI-generated materials as their own work or part of their work constitute an act\nof academic dishonesty. Students who are found committing academic dishonesty will face\ndisciplinary actions.\nReminders for using Generative AI \nGenAI tools can be beneficial, but there are inherent risks too. You should be mindful of the following: \n22 \nUsing Generative AI critically \n1. GenAI tools are language machines that predict the next plausible word or section of code based on\npatterns learned from large datasets. They are not knowledge databases, and may produce codes\nthat have security flaws, bugs, or use illegal libraries.\n2. The datasets that GenAI models learn from may be flawed, biased, or contain inaccuracies and\nlimitations. The models are only as up-to-date as the data they were trained on, and may not reflect\ncurrent events or trends.\n3. GenAI generated text is not always factually correct, and may contain fake citations and references.\nIt may also include offensive material or hidden plagiarism, using words and ideas from human\nauthors without proper referencing.\nUsing Generative AI ethically \n1. You must acknowledge where GenAI tools have been used in an assessment according to accepted\nacademic conventions.  You may make reference to the following:\n\u2022 APA style: https://apastyle.apa.org/blog/how-to-cite-chatgpt \n\u2022 MLA style: https://style.mla.org/citing-generative-ai/ \n\u2022 IEEE style: https://libraryguides.vu.edu.au/ieeereferencing/generativeAI \n\u2022 Harvard style: https://www.citewrite.qut.edu.au/cite/examples/harvard/harvard_internet_ai.html\n\u2022 Chicago style: https://www.chicagomanualofstyle.org/qanda/data/faq/topics/Documentation/faq0422.html \n\u2022 Vancouver style:  https://guides.library.uwa.edu.au/vancouver/GenAI\n2. GenAI systems are amoral and do not know that generating offensive, inaccurate, or misleading\ncontent is wrong.\n3. There are also risks of copyright infringement when using GenAI to generate images or other\ncopyrighted materials.\nUsing Generative AI wisely \nDO\u2019s \n Use GenAI for brainstorming\n Check for factual accuracy of AI-generated content\n Use AI-generated content in conjunction with other sources to ensure your work is reliable and well-\ninformed\n Include any GenAI assistance in your reference list\nDON\u2019Ts \n Do NOT rely solely on AI-generated content as the source of information\n Do NOT ask GenAI software to write your essays\n Do NOT input any personal details or confidential information when using GenAI tools\nReferences: \n1. The University of Edinburgh. (2023). Guidance for students on the use of Generative AI (such as ChatGPT)\nhttps://www.ed.ac.uk/sites/default/files/atoms/files/universityguidanceforstudentsonworkingwithgenerativeai.pdf\n2. Deakin University. (2023). Student guide to using generative AI\nhttps://www.deakin.edu.au/students/study-support/resources-and-referencing/academic-skills/student-guide-\nto-using-generative-ai\nApril 2023\n23 \n"'''
    id = "0"

    handler = SearchManager()
    handler.add_document(text, id)
    
    handler.lexical_search(id, targets=["p", "lan", "g"], connectors=["OR","AND","NOT"], scope="s")
    #handler.lexical_search(id, targets=["plag", "gen"], connectors=["",""], scope="")

    #handler.lexical_search(id, targets=["plag"], connectors=[], scope="s")


    handler.keyword_search(id=id, target="good", synonyms=True)
    #handler.keyword_search(id=id, target="", target_pos="PRON", synonyms=False)
    handler.semantic_search(id=id, query="generative AI", threshold=40)
    